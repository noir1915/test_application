# test_application
Cистема управления пользователями
*****************************
### Описание
Это тестовое задание представляет собой систему управления пользователями, реализованную на Java с использованием Spring Boot. Приложение предоставляет функциональность для управления аккаунтами пользователей, их контактными данными и возможностью перевода средств между пользователями.

## Стек технологий:

Java 17, PostgresSQL, Spring boot (v3.4.5), OpenAPI/Swagger, Maven, Redis, Liquibase, SLF4, JWT, Mock, Lombok

## Общие требование к системе:

1. Архитектура приложения состоит из трех слоев: API, Service, DAO.
2. В системе только обычные пользователи (без администраторов).
3. Пользователи создаются миграциями; операции создания для обычных пользователей отсутствуют.
4. У пользователя может быть более одного телефонного номера (PHONE_DATA), но должен быть как минимум один.
5. У пользователя может быть более одного адреса электронной почты (EMAIL_DATA), но должен быть как минимум один.
6. У пользователя должен быть строго один аккаунт (ACCOUNT).
7. Начальный баланс (BALANCE) в аккаунте указывается при создании пользователя.
8. Баланс в аккаунте не может уходить в минус ни при каких операциях.
   
## Обязательные фичи:

1. Кэширование на уровне API и DAO.
2. Операции CREATE (только для определенных данных внутри пользователя) и UPDATE:
 - Пользователь может изменять только свои данные: добавлять/удалять/изменять email и телефон, если они не заняты другими пользователями.
3. Реализация операции READ для поиска пользователей с фильтрацией по полям:
 - Фильтрация по дате рождения, телефону, имени и email с поддержкой пагинации.
4. JWT токен для аутентификации (необходимый Claim только USER_ID).
5. Автоматическое увеличение баланса каждого клиента на 10% каждые 30 секунд, но не более 207% от начального депозита.
6. Функционал трансфера денег между пользователями с необходимыми валидациями.

Не обязательные фичи (сделаны в минимальном исполнении):

1.	Добавлен swagger (минимальная конфигурация).
3.	Добавлено (значимое) логгирование.

Тестирование:
Тесты на покрытие функционала трансфера денег.

## Запуск проекта:
Скачать проект из репозитория GitHub.
Настроить подключение к базе данных PostgreSQL в файле application.yml.
Сборка проекта с помощью Maven
```
mvn clean install
```
Запуск приложения:
```
mvn spring-boot:run
```
В браузере перейти по адресу http://localhost:8080/swagger-ui/index.html для доступа к Swagger UI (он частичтно настроен)

## Доступные эндпойнты:
### Аутентификация:
* POST `http://localhost:8080/api/v1/auth/login` - аутентификация пользователя по номеру/email или паролю
### Управление пользователями:
* GET `http://localhost:8080/api/v1/users/search` - поиск пользователей с возможностью фильтрации по различным критериям и пагинацией результатов
* GET `http://localhost:8080/api/v1/users/{id}` - получить всю информацию о пользователя по id 
* PUT `http://localhost:8080/api/v1/users/{id}` - обновить пользователя
* DELETE `http://localhost:8080/api/v1/users/{id}` - удалить пользователя
### Перевод средств между пользователями
POST `http://localhost:8080/api/v1/accounts/transfer` - перевести средства от одного пользователя к другому.
### Управление контактными данными:
* POST `http://localhost:8080/api/v1/users/{id}/email` - добавить email пользователя
* PUT `http://localhost:8080/api/v1/users/{id}/email` - обновить email пользователя
* DELETE `http://localhost:8080/api/v1/users/{id}/email` - удалить email пользователя
* POST `http://localhost:8080/api/v1/users/{id}/phone` - добавить номер пользователя
* PUT `http://localhost:8080/api/v1/users/{id}/phone` - обновить номер пользователя
* DELETE `http://localhost:8080/api/v1/users/{id}/phone` - удалить номер пользователя
